import{g as I,r as R}from"./cards-1PonQCFH.js";import{getDatabase as Z,ref as k,get as F,child as z,update as K,push as _,remove as G}from"https://www.gstatic.com/firebasejs/9.15.0/firebase-database.js";import{initializeApp as q}from"https://www.gstatic.com/firebasejs/9.15.0/firebase-app.js";import{GoogleAuthProvider as j,getAuth as U,signOut as P,signInWithPopup as X}from"https://www.gstatic.com/firebasejs/9.15.0/firebase-auth.js";const Y={apiKey:"AIzaSyAc1-FWefRK9gNkaprncldWqK2jztLV43A",authDomain:"guesswhoitis-905ed.firebaseapp.com",databaseURL:"https://guesswhoitis-905ed-default-rtdb.firebaseio.com",projectId:"guesswhoitis-905ed",storageBucket:"guesswhoitis-905ed.firebasestorage.app",messagingSenderId:"72462712048",appId:"1:72462712048:web:a1ed1f84eb16b686b95635"},M=q(Y),J=new j(M),D=U(M),S=Z(M),Q=document.getElementById("logoutBtn"),x=document.getElementById("addCard"),C=document.getElementById("container"),E=window.innerWidth>600?200:150,y=E==200?150:125,f=["Angel Wings","Halo","Clock","Music Notes","Spotlight","Sun","MultiHearts","Pumping Heart","Stars","Rose","Gift","Kiss","Wand"],tt='<p class="effectText">Pumping Heart</p><svg class="w-6 h-6 text-gray-800 dark:text-white svg" aria-hidden="true" xmlns="http://www.w3.org/2000/svg" width="30" height="30" fill="currentColor" viewBox="0 0 24 24"><path fill-rule="evenodd" d="M2 12C2 6.477 6.477 2 12 2s10 4.477 10 10-4.477 10-10 10S2 17.523 2 12Zm5.757-1a1 1 0 1 0 0 2h8.486a1 1 0 1 0 0-2H7.757Z" clip-rule="evenodd"></path> </svg>',et='  <svg xmlns="http://www.w3.org/2000/svg" width="20" viewBox="0 0 20 20" height="20" fill="none" class="svg-icon"><g stroke-width="1.5" stroke-linecap="round" stroke="#de8a2a"><circle r="7.5" cy="10" cx="10"></circle><path d="m9.99998 7.5v5"></path><path d="m7.5 9.99998h5"></path></g></svg><span class="lable">Add</span>',nt=' <svg xmlns="http://www.w3.org/2000/svg"fill="none"viewBox="0 0 39 7"class="bin-top"><line stroke-width="4" stroke="white" y2="5" x2="39" y1="5"></line><line stroke-width="3"stroke="white"y2="1.5"x2="26.0357"y1="1.5"x1="12"></line></svg><svg xmlns="http://www.w3.org/2000/svg"fill="none"viewBox="0 0 33 39"class="bin-bottom"><mask fill="white" id="path-1-inside-1_8_19"><path d="M0 0H33V35C33 37.2091 31.2091 39 29 39H4C1.79086 39 0 37.2091 0 35V0Z"></path></mask><path mask="url(#path-1-inside-1_8_19)"fill="white"d="M0 0H33H0ZM37 35C37 39.4183 33.4183 43 29 43H4C-0.418278 43 -4 39.4183 -4 35H4H29H37ZM4 43C-0.418278 43 -4 39.4183 -4 35V0H4V35V43ZM37 0V35C37 39.4183 33.4183 43 29 43V35V0H37Z"></path><path stroke-width="4" stroke="white" d="M12 6L12 29"></path><path stroke-width="4" stroke="white" d="M21 6V29"></path></svg><svg xmlns="http://www.w3.org/2000/svg"fill="none"viewBox="0 0 89 80" class="garbage"><path fill="white" d="M20.5 10.5L37.5 15.5L42.5 11.5L51.5 12.5L68.75 0L72 11.5L79.5 12.5H88.5L87 22L68.75 31.5L75.5066 25L86 26L87 35.5L77.5 48L70.5 49.5L80 50L77.5 71.5L63.5 58.5L53.5 68.5L65.5 70.5L45.5 73L35.5 79.5L28 67L16 63L12 51.5L0 48L16 25L22.5 17L20.5 10.5Z"></path></svg>';function st(t){const n=k(Z());return F(z(n,t)).then(s=>s.exists()?s.val():(console.log("No data available"),0)).catch(s=>(console.error(s),0))}function it(t,n,s){const a=Date.now();K(k(S,t),{effects:n,message:s,timestamp:a})}function at(t,n){const s=Date.now();return _(k(S,"/wallpaper/"),{effects:t,message:n,timestamp:s}).key}function ot(t){G(k(S,t))}function ct(t){const n=new Date(t),s=n.getFullYear(),a=String(n.getMonth()+1).padStart(2,"0"),c=String(n.getDate()).padStart(2,"0"),e=String(n.getHours()).padStart(2,"0"),i=String(n.getMinutes()).padStart(2,"0"),d=String(n.getSeconds()).padStart(2,"0");return`${s}-${a}-${c} ${e}:${i}:${d} `}function dt(t){const s=Date.now()-t,a=Math.floor(s/(1e3*60*60*24));return`(${a} day${a!==1?"s":""} have passed) `}function W(t,n,s,a){const c=document.createElement("select"),e=document.createElement("div"),i=document.createElement("h4"),d=document.createElement("div");e.classList.add("cardDiv"),e.classList.add("hiding"),d.classList.add("card");const l=document.createElement("P");l.textContent=n,d.appendChild(l);for(let o of t)I(o,d,E,y);t.length||I(0,d,E,y),i.textContent=n,i.addEventListener("click",()=>{e.classList.contains("showing")?(e.classList.remove("showing"),e.classList.add("hiding")):(e.classList.contains("hiding")&&e.classList.remove("hiding"),e.classList.add("showing"))});const p=document.createElement("div"),T=document.createElement("p"),u=document.createElement("input");T.textContent="Mensaje:",u.value=n,u.addEventListener("change",function(){l.textContent=u.value}),p.appendChild(T),p.appendChild(u);const b=document.createElement("p");b.textContent="Última actualización: ",b.textContent+=ct(s)+dt(s);const m=document.createElement("div"),V=document.createElement("p");m.classList="effectsDiv",V.textContent="Efectos: ",m.appendChild(V);function A(o){const r=document.createElement("button");r.classList="Btn",r.innerHTML=tt;const N=r.querySelector(".effectText");N.textContent=f[o-1],r.addEventListener("click",function(){const L=f.indexOf(N.textContent)+1;t=t.filter(O=>O!==L),R(d,L);const H=document.createElement("option");H.value=L,H.textContent=f[L-1],c.appendChild(H),m.removeChild(r)}),m.appendChild(r)}for(let o of t)A(o);const $=document.createElement("p"),h=document.createElement("div"),g=document.createElement("button");g.classList="button",g.innerHTML=et,h.classList="effectsDiv",$.textContent="Nuevo efecto: ",h.appendChild($);for(let o=0;o<f.length;o++){if(t.includes(o+1))continue;const r=document.createElement("option");r.id=`n${o}`,r.value=o+1,r.textContent=f[o],c.appendChild(r)}g.addEventListener("click",function(){if(c.options.length){t.push(parseInt(c.value)),I(parseInt(c.value),d,E,y),A(parseInt(c.value));const o=c.options[c.selectedIndex];o&&o.remove()}}),h.appendChild(c),h.appendChild(g);const w=document.createElement("div");w.classList="effectsDiv";const B=document.createElement("button");B.textContent="Confirmar",w.appendChild(B),B.addEventListener("click",function(){e.classList.contains("showing")?(e.classList.remove("showing"),e.classList.add("hiding")):(e.classList.contains("hiding")&&e.classList.remove("hiding"),e.classList.add("showing")),i.textContent=l.textContent,a==-1?a=at(t,l.textContent):it("/wallpaper/"+a,t,l.textContent)});const v=document.createElement("button");v.classList="bin-button",v.innerHTML=nt,w.appendChild(v),v.addEventListener("click",function(){C.removeChild(i),C.removeChild(e),a!=-1&&ot("wallpaper/"+a)}),e.appendChild(p),e.appendChild(b),e.appendChild(m),e.appendChild(h),e.appendChild(d),e.appendChild(w),C.insertBefore(i,x),C.insertBefore(e,x)}async function rt(t){t.uid!=="lpxjXmLNAibp7UGgRs2Pk4bN0kd2"&&(P(D),window.location.href="index.html"),x.style.display="block";const n=await st("/"),s=Object.entries(n.wallpaper);s.sort(([,i],[,d])=>i.timestamp-d.timestamp);const a=s.map(([,i])=>i),c=s.map(([i])=>i),e=a.length;for(let i=0;i<e;i++){const d=Object.values(a.at(i).effects),l=a.at(i).message,p=a.at(i).timestamp;W(d,l,p,c.at(i))}}Q.addEventListener("click",()=>{P(D),window.location.href="index.html"});x.addEventListener("click",function(){W([],"New Card",0,-1)});document.getElementById("signInBtn").addEventListener("click",async()=>{await X(D,J).then(async t=>{j.credentialFromResult(t).accessToken;const s=t.user;rt(s),document.getElementById("signInBtn").style.display="none"}).catch(t=>{t.code;const n=t.message;alert(n)})});document.getElementById("backBtn").addEventListener("click",()=>{window.location.href="index.html"});
